
import os
from flask import Flask, request, render_template, session
from googleapiclient.discovery import build
from datetime import datetime, timezone
from dateutil.parser import parse

app = Flask(__name__)
app.secret_key = os.urandom(24)
API_KEY = os.environ.get("YOUTUBE_API_KEY")

GENRES = [
    "教育・解説", "ビジネス・副業", "ゲーム・実況", "エンタメ・バラエティ",
    "音楽・歌ってみた", "美容・ファッション", "グルメ・料理", "Vlog・ライフスタイル",
    "ママ・育児", "ペット・動物", "スポーツ・筋トレ・健康", "車・バイク・乗り物",
    "占い・スピリチュアル", "作業・DIY・クラフト", "2ch・なんJ", "本・要約・読書系",
    "メンタル・自己啓発", "映画・アニメ考察", "旅行・観光・絶景", "AI・ツール紹介",
    "恋愛・男女心理", "オカルト・ミステリー", "未分類"
]

GENRE_KEYWORDS = {
    "教育・解説": ["解説", "勉強", "授業", "知識", "学ぶ", "講義", "教養"],
    "ビジネス・副業": ["副業", "稼ぐ", "投資", "起業", "収益", "フリーランス", "資産"],
    "ゲーム・実況": ["ゲーム", "実況", "プレイ", "攻略", "配信", "eスポーツ"],
    "エンタメ・バラエティ": ["バラエティ", "お笑い", "ネタ", "ドッキリ", "面白い", "企画"],
    "音楽・歌ってみた": ["歌ってみた", "カバー", "演奏", "ギター", "ピアノ", "作曲", "ボカロ", "音楽"],
    "美容・ファッション": ["美容", "メイク", "スキンケア", "コスメ", "ファッション", "スタイル", "髪型"],
    "グルメ・料理": ["料理", "レシピ", "グルメ", "モッパン", "食レポ", "食べてみた", "スイーツ"],
    "Vlog・ライフスタイル": ["Vlog", "暮らし", "ルーティン", "日常", "丁寧な暮らし", "ライフスタイル"],
    "ママ・育児": ["育児", "子育て", "ママ", "ベビー", "出産", "離乳食"],
    "ペット・動物": ["ペット", "犬", "猫", "うさぎ", "ハムスター", "動物", "癒し"],
    "スポーツ・筋トレ・健康": ["筋トレ", "ストレッチ", "健康", "運動", "ダイエット", "フィットネス", "体操"],
    "車・バイク・乗り物": ["車", "バイク", "ドライブ", "カスタム", "乗り物", "交通", "モビリティ", "鉄道"],
    "占い・スピリチュアル": ["占い", "スピリチュアル", "タロット", "波動", "宇宙", "霊視"],
    "作業・DIY・クラフト": ["DIY", "修理", "クラフト", "作業", "レザークラフト", "ハンドメイド", "工具"],
    "2ch・なんJ": ["2ch", "なんJ", "なんでも実況", "スレ", "掲示板", "まとめ", "にちゃんねる"],
    "本・要約・読書系": ["本要約", "読書", "書評", "名著", "ビジネス書", "本解説"],
    "メンタル・自己啓発": ["メンタル", "自己肯定感", "マインド", "悩み", "生きづらい", "ポジティブ", "心理学"],
    "映画・アニメ考察": ["映画", "アニメ", "考察", "レビュー", "伏線", "解説", "ランキング"],
    "旅行・観光・絶景": ["旅行", "観光", "絶景", "ホテル", "温泉", "日本一周", "海外旅行"],
    "AI・ツール紹介": ["AI", "ChatGPT", "ツール", "自動化", "便利", "業務効率", "アプリ"],
    "恋愛・男女心理": ["恋愛", "好きな人", "モテ", "デート", "告白", "男心", "女心", "婚活", "カップル"],
    "オカルト・ミステリー": ["オカルト", "怪談", "心霊", "都市伝説", "幽霊", "怖い話", "UFO", "未確認生物", "陰謀", "超常現象"]
}

def guess_genre(text):
    for genre, keywords in GENRE_KEYWORDS.items():
        if any(keyword in text for keyword in keywords):
            return genre
    return "未分類"

@app.route("/")
def index():
    return render_template("index.html")

@app.route("/terms")
def terms():
    return render_template("terms.html")
